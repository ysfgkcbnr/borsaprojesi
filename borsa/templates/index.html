<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anasayfa | Borsa Platformu</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body class="bg-gray-100">
    <nav class="bg-blue-900 text-white p-4 flex justify-between items-center sticky top-0 z-50">
        <div class="text-xl font-bold">Borsa Platformu</div>
        <button id="menu-toggle" class="md:hidden block text-white focus:outline-none">☰</button>
        <ul id="menu" class="hidden md:flex space-x-6">
            <li><a href="#" class="hover:text-gray-300">Anasayfa</a></li>
            <li><a href="analysis" class="hover:text-gray-300">Teknik Analiz</a></li>
            <li><a href="#" class="hover:text-gray-300">Haberler</a></li>
            <li><a href="premium" class="hover:text-gray-300">Premium</a></li>
            <li><a href="profile" class="hover:text-gray-300">Profil</a></li>
            <li><a href="login" class="hover:text-gray-300">Giriş/Kayıt Ol</a></li>
        </ul>
    </nav>

    <div class="container mx-auto p-6 pt-20">
        <!-- Borsa Verileri -->
        <div class="bg-white shadow-lg rounded-lg p-6 mb-6">
            <h2 class="text-xl font-semibold mb-4">Canlı Borsa Verileri</h2>
            <table class="w-full border-collapse border border-gray-300">
                <thead>
                    <tr class="bg-gray-200">
                        <th class="border p-2">Hisse</th>
                        <th class="border p-2">Fiyat</th>
                        <th class="border p-2">Değişim (%)</th>
                        <th class="border p-2">Hacim</th>
                    </tr>
                </thead>
                <tbody id="stock-data">
                    <tr class="text-center">
                        <td class="border p-2" id="ticker">THYAO</td>
                        <td class="border p-2" id="close-price">Veri Yükleniyor...</td>
                        <td class="border p-2" id="price-change">Veri Yükleniyor...</td>
                        <td class="border p-2" id="volume">Veri Yükleniyor...</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // Mobil Menü Aç/Kapa
        document.getElementById('menu-toggle').addEventListener('click', function() {
            document.getElementById('menu').classList.toggle('hidden');
        });

        // Hisse verilerini her dakika güncelle
        function fetchStockData() {
            $.ajax({
                url: "/update-stock-data/",
                method: "GET",
                success: function(response) {
                    // Yeni verileri tabloya yerleştir
                    $('#close-price').text(response.close_price);
                    $('#price-change').text(response.price_change.toFixed(2) + '%');
                    $('#volume').text(response.volume);
                },
                error: function() {
                    alert("Veri güncellenemedi.");
                }
            });
        }

        // Hisse verisini her dakika bir kez güncelle
        setInterval(fetchStockData, 60000); // 60000 ms = 1 dakika
    </script>
</body>
</html>
